# Удаление профилей пользователей и связанных с ними записей в реестре.

> [!IMPORTANT]
> Скрипт протестирован более чем на 7 АРМах!

## Описание:
### Скрипт удаляет: 
- Директории пользователей из `C:\Users` 
- Ветки пользователей в реестре по пути `HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList` 

### Скрипт не трогает: 
- Текущего пользователя
- Папки и пути в реестре указанные ниже. (регистр не важен):
```
    "Default", 
    "Public", 
    "Общие", 
    "Default User", 
    "Пользователь по умолчанию", 
    "Administrator", 
    "Администратор", 
    "dezhur112", 
    "defaultuser", 
    "defaultuser0", 
    "admin112", 
    "user", 
    "secure", 
    "systemprofile", 
    "LocalService", 
    "NetworkService", 
```

## Запуск:
> [!WARNING]
> Желательно перезагрузить компьютер перед запуском, что б не осталось запушенных профилей Windows.
1. Скачиваем два фала `main.ps1` и `clear.ps1` из папки `src`
2. Запускать файл `main.ps1` (ПКМ => Выполнить с помощью PowerShell)

Здесь в PowerShell может появится запрос на разрешение запуска скриптов

<img src="/data/img/except_set.png" alt="sch" style="max-width: 100%;">

Нужно отвечать `[Y] Да - Y` или `[A] Да для всех - A`, я обычно отвечаю `[Y] Да - Y`
Кому интересно, можно почитать подробнее [тут](https://winrcmd.wordpress.com/2019/01/23/razreshit-powershell-scripty-powershell-execution-policy/) 

3. Сначала начнется скачивание PowerShell 7, если его еще нет, или если его версия ниже 7.3.10. Нужно дождаться загрузки и установки (примерно 1 - 2 минуты).
4. Дальше пойдет удаление папок пользователей и ключей в реестре.
> [!WARNING]
> После очистки так же желательно перезагрузить компьютер.

## Заметки:
- [x] Чистит полностью забитый Acer примерно за 5 минут. (Это с учетом установки PS7)
- [x] Никаких подтверждений при удалении не требуется, в отличие от ручного удаления.

## Планы по доработке:
> Если появятся баги, будем исправлять...

## Авторы:
- [Denis Shahbazyan](https://github.com/DenisShahbazyan)

## Лицензия:
- MIT